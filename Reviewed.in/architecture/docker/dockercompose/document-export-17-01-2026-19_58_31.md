# Docker

FROM maven:3.9.4-eclipse-temurin-21-alpine

WORKDIR /app

COPY ./target/SecurityApp-0.0.1-SNAPSHOT.jar .

EXPOSE 8080

CMD ["java", "-jar", "SecurityApp-0.0.1-SNAPSHOT.jar"]





--------------------------------------------------


```
# Docker Compose file that runs 3 services:
# 1) MySQL database
# 2) Spring Boot backend API
# 3) React frontend UI
# All are connected using Docker networks
services:

  # -----------------------------
  # 1) MYSQL DATABASE SERVICE
  # -----------------------------
  mysql:
    # Pull official MySQL image from Docker Hub
    image: mysql:8.0

    # Give a fixed container name (instead of auto-generated name)
    container_name: reviewed-mysql

    # Restart container automatically unless you stop it manually
    restart: unless-stopped

    # Environment variables used by MySQL image during initialization
    environment:
      # Database name to create at startup (only when volume is empty)
      MYSQL_DATABASE: reviewed

      # Root password for MySQL root user
      MYSQL_ROOT_PASSWORD: Sai2714@sql

    # Persist DB data and run init SQL scripts
    volumes:
      # Store MySQL data permanently in a docker volume (data won't be lost on restart)
      - mysql_data:/var/lib/mysql

      # Run SQL scripts automatically when DB is created first time
      # Any .sql placed in ./mysql-init will auto-execute
      - ./mysql-init:/docker-entrypoint-initdb.d

    # Health check makes sure DB is ready before backend starts
    healthcheck:
      # Command to check DB is alive
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost", "-uroot", "-pSai2714@sql"]

      # Run healthcheck every 10 seconds
      interval: 10s

      # Wait 5 seconds for healthcheck to complete
      timeout: 5s

      # Try 15 times before marking as unhealthy
      retries: 15

    # Connect MySQL only to private network
    # So it is not directly accessible from other networks
    networks:
      - private_net


  # -----------------------------
  # 2) SPRING BOOT BACKEND SERVICE
  # -----------------------------
  app:
    # Use already-built backend Docker image (NO local build)
    # This image must exist in your local docker images (or registry)
    image: reviewedin-app:latest

    # Fixed backend container name
    container_name: reviewed-app

    # Restart automatically if crashed
    restart: unless-stopped

    # Start backend only after mysql becomes healthy
    depends_on:
      mysql:
        condition: service_healthy

    # Environment variables injected into Spring Boot application
    environment:
      # Spring Boot application name
      SPRING_APPLICATION_NAME: Reviewed

      # Database connection URL inside docker network
      # "mysql" here is NOT localhost â€” it is the mysql service hostname
      SPRING_DATASOURCE_URL: jdbc:mysql://mysql:3306/reviewed?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true

      # DB username
      SPRING_DATASOURCE_USERNAME: root

      # DB password
      SPRING_DATASOURCE_PASSWORD: Sai2714@sql

      # Auto update DB schema using Hibernate
      SPRING_JPA_HIBERNATE_DDL_AUTO: update

      # Pretty print SQL in logs
      SPRING_JPA_PROPERTIES_HIBERNATE_FORMAT_SQL: "true"

      # Allows schema.sql/data.sql to run after Hibernate
      SPRING_JPA_DEFER_DATASOURCE_INITIALIZATION: "true"

      # Hibernate dialect for MySQL
      SPRING_JPA_PROPERTIES_HIBERNATE_DIALECT: org.hibernate.dialect.MySQLDialect

      # Custom values used by your backend
      apikey: fa070261
      omdb_api_url: https://www.omdbapi.com/
      deploy_env: development
      jwt_secretKey: r123view123ed2714reviewedwebsitew123234p

    # expose makes backend accessible ONLY inside docker networks
    # It does NOT publish to your laptop
    expose:
      - "8080"

    # Backend is only on private network (security)
    networks:
      - private_net


  # -----------------------------
  # 3) REACT FRONTEND SERVICE
  # -----------------------------
  react:
    # Use already-built React Docker image (NO local build)
    image: reviewedui-react:v0.0.1

    # Fixed frontend container name
    container_name: reviewed-react

    # Restart unless stopped
    restart: unless-stopped

    # Ensure backend starts before react
    depends_on:
      - app

    # Publish frontend to host machine
    # host 3000 -> container 80 (nginx serving react build)
    ports:
      - "3000:80"

    # Attach frontend to both networks:
    # - public_net : accessible to host/browser
    # - private_net: can talk to backend service internally
    networks:
      - public_net
      - private_net


# -----------------------------
# VOLUMES
# -----------------------------
volumes:
  # Volume used by MySQL to store DB files permanently
  mysql_data:


# -----------------------------
# NETWORKS
# -----------------------------
networks:
  # Public network for services exposed to outside world
  public_net:
    driver: bridge

  # Private network for internal communication (react -> app -> mysql)
  private_net:
    driver: bridge
```
